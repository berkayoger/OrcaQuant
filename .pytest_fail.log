============================= test session starts ==============================
platform linux -- Python 3.12.1, pytest-8.4.1, pluggy-1.6.0 -- /workspaces/ytd-kopya/.venv/bin/python
cachedir: .pytest_cache
rootdir: /workspaces/ytd-kopya
configfile: pytest.ini
plugins: Faker-25.9.2, anyio-4.10.0, cov-4.1.0
collecting ... collected 178 items

backend/tests/test_decision.py::test_predict_decision_success PASSED     [  0%]
backend/tests/test_decision.py::test_predict_decision_invalid_json PASSED [  1%]
backend/tests/test_draks_copy_evaluate.py::test_copy_eval_flag_off FAILED [  1%]

=================================== FAILURES ===================================
___________________________ test_copy_eval_flag_off ____________________________

app = <Flask 'backend.app'>, user = <User 1>
auth_headers = {'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJpYXQiOjE3NTY4MzYwNDQsImlzcyI6Inl0ZC1...IiwiZnJlc2giOnRydWV9.KvZEWqVTgFbKKEpwS8_gW4Ews2sDtLr8grhyg2Se8_k', 'X-API-KEY': '37efe0a2-d1bb-469c-b42d-399afa3ff26b'}

    def test_copy_eval_flag_off(app, user, auth_headers):
        client = app.test_client()
        with app.app_context():
>           create_feature_flag("draks", False)
E           TypeError: create_feature_flag() takes from 0 to 1 positional arguments but 2 were given

backend/tests/test_draks_copy_evaluate.py:72: TypeError
---------------------------- Captured stderr setup -----------------------------
{"asctime": "2025-09-02 18:00:44,070", "levelname": "INFO", "name": "backend.app", "message": "app_boot", "pathname": "/workspaces/ytd-kopya/backend/app/__init__.py", "lineno": 35, "funcName": "create_app", "stage": "init"}
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/pythonjsonlogger/jsonlogger.py:11
  /workspaces/ytd-kopya/.venv/lib/python3.12/site-packages/pythonjsonlogger/jsonlogger.py:11: DeprecationWarning: pythonjsonlogger.jsonlogger has been moved to pythonjsonlogger.json
    warnings.warn(

backend/utils/feature_flags.py:52
backend/utils/feature_flags.py:52
  /workspaces/ytd-kopya/backend/utils/feature_flags.py:52: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return datetime.utcnow().isoformat()

.venv/lib/python3.12/site-packages/pandas_ta/__init__.py:7
  /workspaces/ytd-kopya/.venv/lib/python3.12/site-packages/pandas_ta/__init__.py:7: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
    from pkg_resources import get_distribution, DistributionNotFound

.venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /workspaces/ytd-kopya/.venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

backend/tests/test_decision.py::test_predict_decision_success
  /workspaces/ytd-kopya/backend/decision_engine/decision_maker.py:28: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "valid_until": (datetime.utcnow() + timedelta(days=7)).isoformat(),

backend/tests/test_draks_copy_evaluate.py::test_copy_eval_flag_off
backend/tests/test_draks_copy_evaluate.py::test_copy_eval_flag_off
backend/tests/test_draks_copy_evaluate.py::test_copy_eval_flag_off
  /workspaces/ytd-kopya/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:3624: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return util.wrap_callable(lambda ctx: fn(), fn)  # type: ignore

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED backend/tests/test_draks_copy_evaluate.py::test_copy_eval_flag_off - TypeError: create_feature_flag() takes from 0 to 1 positional arguments but 2 were given
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
=================== 1 failed, 2 passed, 9 warnings in 1.62s ====================
